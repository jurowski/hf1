

<h1>Challenge Program: <%= @program.name %></h1>

<div style="background-color:#ffffff;padding:10px;padding-top:5px;margin:10px;margin-left:0px;border-color:#eeeeee;border:2px;border-style:solid;">

  <% if @program.organization %>
    <p>
      <b>Organization:</b>
      <%=h @program.organization_id %>
    </p>
  <% end %>

<p>
  <b>Managed by user:</b>
  <% #h @program.managed_by_user_id %>
  <%= @program.managed_by_user.name %> (<%= @program.managed_by_user.email %>)
</p>

<% if @program.about %>
<p>
  <b>About:</b>
  <%= @program.about %>
</p>
<% end %>

<p>
  <b>Image logo:</b>
  <%=h @program.image_logo %>

  <% if @program.link_image_to_external_site and @program.external_membership_url %>
  <a href="<%= @program.external_membership_url %>" target="_parent"><img src="/home/images/programs/<%= @program.image_logo %>" /></a>
  <% else %>
  <img src="/home/images/programs/<%= @program.image_logo %>" />
  <% end %>
</p>


<% if @program.status and @program.status == "live" %>
  <input type=checkbox checked disabled>
<% else %>
  <input type=checkbox disabled>
<% end %>
 Publish

 <br>


<% if @program.actions_list_dropdown %>
  <input type=checkbox checked disabled>
<% else %>
  <input type=checkbox disabled>
<% end %>
 Display actions as a dropdown instead of a list



<h3>External Site</h3>

<p>
  <b>URL for External Link:</b>
  <%=h @program.external_membership_url %>
</p>

<p>
  <b>Name of External Site:</b>
  <%=h @program.external_membership_text %>
</p>

<p>
<% if @program.link_image_to_external_site %>
  <input type=checkbox checked disabled>
<% else %>
  <input type=checkbox disabled>
<% end %>
Make the Program Image clickable, linked to External URL
</p>

<p>
<% if @program.requires_external_membership %>
  <input type=checkbox checked disabled>
<% else %>
  <input type=checkbox disabled>
<% end %>
 External Membership Required to Join (Hides Action Items and point the Join Button to External URL)
</p>






</div>

<%= link_to 'Edit', edit_program_path(@program), :class => "btn blue", :title => "Modify Program Details.", :id => "edit_" + @program.id.to_s %>
    <script type='text/javascript'>
        $('#edit_<%= @program.id.to_s %>').tipsy();
    </script>

<%= link_to 'Preview', '/programs/' + @program.id.to_s + '/view', :class => "btn blue", :title => "Show how the program will look when other people view it.", :id => "preview_" + @program.id.to_s %>
    <script type='text/javascript'>
        $('#preview_<%= @program.id.to_s %>').tipsy();
    </script>


<% if @program.can_delete %>
(no actions, no users, delete program    <%= link_to '- Delete Program', @program, :confirm => 'Delete this program? (there are no associated users or actions)', :method => :delete, :class => "btn mini red" %>)
<% else %>


    <a id='delete_disabled_<%= @program.id.to_s %>'  class="btn disabled" title="(There are associated actions or users, so can not delete)." ><i class="icon-pause"></i>- Delete Program</a>
    <script type='text/javascript'>
        $('#delete_disabled_<%= @program.id.to_s %>').tipsy();
    </script>


<% end %>

<hr>
<h3>Action Items for this Program</h3>

<div style="background-color:#ffffff;padding:10px;padding-top:5px;margin:10px;margin-left:0px;border-color:#eeeeee;border:2px;border-style:solid;">
<% @program_templates = ProgramTemplate.find(:all, :conditions => "program_id = '#{@program.id}'", :order => "listing_position") %>

<% @program_templates.each do |program_template| %>

  <br>

    <% 
    pos = ""
    if program_template.listing_position
      pos = program_template.listing_position.to_s + ". "
    end
    %>

    <%= pos %><%= link_to program_template.template.template_tagline, program_template %>
    <%= link_to '- Drop from Program', program_template, :confirm => 'Drop "' + program_template.template.template_tagline + '" from this program? (this will not delete the action template itself)', :method => :delete, :class => "btn mini red" %>
    <br>
<% end %>

</div>
<a href="/program_templates/new?program_id=<%= @program.id.to_s %>" class="btn green">+ Add an Action Item</a>
<hr>



<h3>Users Enrolled in this Program</h3>

<div style="background-color:#ffffff;padding:10px;padding-top:5px;margin:10px;margin-left:0px;border-color:#eeeeee;border:2px;border-style:solid;">
<% @program_enrollments = ProgramEnrollment.find(:all, :conditions => "program_id = '#{@program.id}'") %>

<% if @program_enrollments.size == 0 %>
  (None)
<% end %>
<% @program_enrollments.each do |program_enrollment| %>

  <br>

    <%= link_to program_enrollment.user.name, program_enrollment %>
    <%= link_to '- Drop from Program', program_enrollment, :confirm => 'Drop "' + program_enrollment.user.name + '" from this program? (this will not delete the actual user record, but will remove the enrollment)', :method => :delete, :class => "btn mini red" %>
    <br>
<% end %>


</div>



  <div class="div_program_<%= @program.id %>_manage_program_invites" id="div_program_<%= @program.id %>_manage_program_invites">
    <%= render :partial => "invites/manage_program_invites", :locals => { :program => @program }  %>
  </div>


<a href="/program_enrollments/new?program_id=<%= @program.id.to_s %>" class="btn green">+ Invite a User to Preview this Program</a>
<hr>
