
	

--------------------- :::TODO::: ----------------------------


:::CURRENT::: 




new class: invite
invite
from_user_id
to_name
to_email
to_user_id
purpose_join_team_id
purpose_follow_goal_id
purpose_friend_user_id
accepted_on
declined_loudly_on
declined_silently_on
first_sent_on
last_resent_on


Custom Teams Overview
----------------------
i want to build my own custom team related to a goal
Allow for someone to Build a Custom Team in which there are openings ... so that people can seek out open teams and choose rather than having to be randomly assigned

Custom Teams ToDo
--------------------

CURRENT

done--set custom teams to invite-only by default
done--remove the UI for changing custom invite-only boolean value (make them always invite-only)

done/test in prod--when user is joining a random team, do not let them join a CUSTOM team

done/test MIGHT NOT BE WORKING IN PRODUCTION--in the team cron jobs, do not re-balance any of the custom teams

--the email invitation going out should have a link that says: Join This Team ... clicking it would automatically create their account and would auto-confirm that account as well ... and it would take them to the goal-creation screen either with the category pre-defined or as a goal based on a template ... and at the top it should mention they're joining a team, and it should describe that team

--users should be able to view all of their invitations when logged in (next to messages)

--users should be able to decline or ignore their invitations

--when someone accepts a team invitation and joins that team, a message needs to go out to every member of the team, and it should prompt each member to send a welcome message to that new team member

--test that if someone has an active goal but tries to start a new goal as part of an invitation, they need to go premium to do that

--someone who already has a goal needs to be able to join it to a team if a matching invitation exists


--if i delete a goal that was part of a custom team with no-one else on it, delete the team as well



NEXT

(for admin user only for now... eventually enable for everyone but only once we have a searchable library that would make it relevant for others to find)
1. make a button in the normal "goals" view that checks if the goal is already part of a template... and if it's not, enable a button that would kick off copy_goal_to_template_and_make_template_parent




modify team:new and team:edit forms so that only relevant fields are shown to owners
change rights on team controller methods so that no one but admin and team owner can edit or delete a team
do not let owner change a team "type" from category to goal-specific once it is created (force delete instead)
make sure you can't delete a team without first removing all members

the presence of team.goal_template_parent_id is what makes it goal-specific vs. category-specific

do not let me place my own goal on hold or delete it if i am part of a team (force me to quit the team first)


[ ]  let me choose whether the team should restrict access for that goal itself (team-goal) or for the goal's general category (team-category)

[ ]  if team-goal, make each team goal the child of a template (if my goal is not yet a child, copy it to a parent template)

[ ]  suggest a team name, and let me edit it

[ ]  do not allow random assignments to my custom team

[ ]  let me be the owner of my team

[ ]  let me choose how many people are on my custom team

[ ]  let me craft an invite that has a link to start my goal (and if I have chosen category-level vs. goal-level, a link to start a custom or click from an array of templated goals in the same category)

[ ]  let me send invites to team members

[ ]  let my invite go to multiple email addresses separated by commas

[ ]  (teamgoals) do not kick people off of my custom team for not checking in

[ ]  do not let me quit a team that I am the leader of if there are other members
[ ]  allow me to transfer ownership to another member of the team
[ ]  notify every team member when a new member arrives
[ ]  notify every team member when a member leaves
[ ]  let me email the whole team
[ ]  when emailing one team member ask me to consider including each of the others

[ ]  when an invitee logs in, have an "invites" link at the top showing a red number and a listing of invites to review
[ ]  when an invitee accepts, take them to goal creation
[ ]  allow an invitee to silently ignore an invite (do not email me)
[ ]  allow an invitee to decline an invite (email me)
[ ]  keep reminding an invitee for a while until they take action

[ ]  later: team chat board
[ ]  later: weekly meeting for those who cited weekly meeting availability windows that match (you must attend 2/3 of the meetings over a 3 month period) ... meetings can be in a google hangout URL or in the built-in chat board
[ ]  later: nightly report option of "what went well today" and "what can i improve upon for tomorrow"

[ ]  later: add an icon/mascot/avatar for our team)
[ ]  later: add a "fade or not" photo mosaic linked to each team member's last 7 days ... one row per person)


---------------------------------------------------------------
DONE BELOW (related to Custom Teams)
---------------------------------------------------------------
if i've not yet chosen a category, prompt me to do so first

----------------------
mod table "teams"
----------------------
goal_template_parent_id (nil if category only)
custom # boolean, nil or false if randomized team)
owner_user_id

--------------
new table "team_invites"
--------------
team_id ### which team is this invite for
email_original ### email it was originally sent to
user_id ### once they sign up or if already signed up
goal_id ### once they accept the goal, which of their own goals is in the team
first_sent_date ### invite creation date
remind_until_date ### how long should we send reminders for
remind_every_n_days ### how frequently should we send reminders
last_reminded_date ### the last time a reminder was sent
declined_date ### if the end user declines (send notice to inviter)
ignored_date ### if the end user silently declines (do not send notice to inviter)
accepted_date ### if the end user accepts (send notice to all team members)




-------------------- :::FUTURE::: -------------------------------


--Display badges for those with 100+ 200+ ... etc. impact points

--Telling a long-standing goal to display all checkpoints takes forever... do some paging for this (ex: prod kaybing http://habitforge.com/goals/single/40822)



problem: if a cron job dies i am not aware
solution: look @ the latest cron job ... implement the same (it has a notify gmail that a script died)


future: put a silver or gold badge next to names on dynamic (and in their account) for impact point levels

future: make an option for showing in dynamic only those goals in your categories
future: make an option for showing in dynamic all except porn/masterbate

future: program creation like the UWHealth "holiday don't gain"


-------------------- :::DONE::: -------------------------------

problem: people are starting to ask to cash in support points more than once
solution: 
add a new user field that indicates that they've cashed one in already
modify the admin interface to indicate this and to not allow the single-press button


